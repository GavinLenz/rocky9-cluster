---
# These are derived from the top-level inventory vars:

# Repository Paths
controller_cluster_repo_root: "{{ cluster_repo_root }}"
controller_cluster_config_root: "{{ cluster_config_root }}"
controller_cluster_meta_root: "{{ cluster_meta_root }}"

# Core Cluster Metadata
controller_cluster_name: "{{ cluster_name | default('cluster') }}"
controller_cluster_description: >-
  {{ cluster_description | default('High-performance cluster controller') }}

# Python / Virtual Environment
controller_python_version: "3.9"
controller_python_executable: "/usr/bin/python3"
controller_python_system_packages:
  - python3
  - python3-devel
controller_venv_path: "{{ controller_cluster_repo_root }}/.venv"
controller_venv_bin: "{{ controller_venv_path }}/bin"
controller_venv_python: "{{ controller_venv_bin }}/python"
controller_venv_pip: "{{ controller_venv_bin }}/pip"
controller_venv_ansible: "{{ controller_venv_bin }}/ansible"

controller_venv_bootstrap_packages:
  - pip==24.0
  - setuptools==69.0.3
  - wheel==0.42.0

controller_requirements_file: "{{ controller_cluster_repo_root }}/requirements/controller.txt"
controller_ansible_collections_requirements: >-
  {{ controller_cluster_repo_root }}/requirements/requirements.yml
controller_ansible_core_expected_version: "2.15.8"  # Keep in sync with requirements/controller.txt

# Controller Identity
controller_user: "{{ ansible_user | default('ansible') }}"
controller_group: "{{ controller_user }}"
controller_mode: "0755"
controller_hostname: "{{ inventory_hostname }}"

# Networking (from network_config in inventory)
controller_interface: "{{ network_config.pxe_iface }}"
controller_ip: "{{ network_config.server_ip }}"
controller_gateway: "{{ network_config.gateway | default(network_config.server_ip, true) }}"
controller_dns: "{{ network_config.dns }}"
controller_subnet: "{{ network_config.subnet }}"
controller_dhcp_range_start: "{{ network_config.dhcp_range.start }}"
controller_dhcp_range_end: "{{ network_config.dhcp_range.end }}"

# PXE Integration (exposed via inventory already; keep for compatibility)
controller_pxe_install_drive: "{{ pxe_config.install.drive | default('nvme0n1') }}"
controller_pxe_default_target: "{{ pxe_config.ipxe.default_target | default('local') }}"
